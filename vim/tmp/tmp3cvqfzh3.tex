% Input your problem and solution below.
% Three dashes on a newline indicate the breaking points.

---

Let $A_0BC_0D$ be a convex quadrilateral inscribed in a circle $\omega$. For all integers $i\ge0$, let $P_i$ be the intersection of $\overline{A_iB}$ and $\overline{C_iD}$, let $Q_i$ be the intersection of $\overline{A_iD}$ and $\overline{BC_i}$, let $M_i$ be the midpoint of $\overline{P_iQ_i}$, and let $\overline{M_iA_i}$ and $\overline{M_iC_i}$ intersect $\omega$ again at $A_{i+1}$ and $C_{i+1}$, respectively. The circumcircles of $\triangle A_3M_3C_3$ and $\triangle A_4M_4C_4$ intersect at two points $U$ and $V$.

If $A_0B=3$, $BC_0=4$, $C_0D=6$, $DA_0=7$, then $UV$ can be expressed in the form $\tfrac{a\sqrt b}c$ for positive integers $a$, $b$, $c$ such that $\gcd(a,c)=1$ and $b$ is squarefree. Find $100a+10b+c$.

---

The circles $(A_iM_iC_i)$ are coaxial for all nonnegative integers $i$. Let $R=\overline{A_0C_0}\cap\overline{BD}$. Since $\overline{A_iA_{i+1}}\cap\overline{C_iC_{i+1}}=M_i$ for all $i$, by Brokard's theorem $\overline{A_iC_i}\cap\overline{A_{i+1}C_{i+1}}$ lies on the polar of $M_i$. Hence we have by induction that all $\overline{A_iC_i}$ concur on at $R$. Thus $\overline{P_iQ_i}$ is always the polar of $R$, so the points $P_i$ and $Q_i$ are all collinear on a line $\ell$.
\begin{iclaim*}
    Let $ABCD$ be a quadrilateral with circumcircle $\omega$ and circumcenter $O$, and let $P=\overline{AB}\cap\overline{CD}$, $Q=\overline{AD}\cap\overline{BC}$, $R=\overline{AC}\cap\overline{BD}$. The reflection of $\overline{BD}$ in $\overline{OR}$ intersects $\overline{PQ}$ at $U$, and $M$ is the midpoint of $\overline{PQ}$. Let $V$ be the foot from $O$ to $\overline{RU}$. Then $CMUAV$ is cyclic.
\end{iclaim*}
\begin{proof}
    Let $T=\overline{AC}\cap\overline{PQ}$. Let $S$ be the Miquel point of $APQC$ and $K$ the Miquel point of $AQPC$. Then the spiral similarity at $S$ sending $\overline{AC}$ to $\overline{PQ}$ sends $N$ to $M$, and the spiral similarity at $K$ sending $\overline{AC}$ to $\overline{QP}$ sends $N$ to $M$. Hence $S$, $K$, $T$, $M$, $N$ are concyclic.
    \begin{center}
        \begin{asy}
            size(11.5cm); defaultpen(fontsize(10pt));
            pen pri=orange;
            pen sec=heavyred;
            pen tri=royalblue;
            pen qua=heavycyan;
            pen qui=lightblue;
            pen sex=purple+pink;
            pen fil=yellow+opacity(0.05);
            pen sfil=sec+opacity(0.05);
            pen tfil=tri+opacity(0.05);
            pen qfil=qua+opacity(0.05);
            pen qifil=qui+opacity(0.05);
            pen sefil=sex+opacity(0.05);

            pair O,P,Q,M,B,A,C,D,NN,R,T,Bp,Dp,SS,K,U,V;
            O=(0,0);
            P=(-0.6,-1.5);
            Q=extension(P,P+(1,0),reflect( (0,0),(1,0))*(1/P),reflect( (0,0),(1,0))*(1/P)+P*(0,1));
            M=(P+Q)/2;
            B=dir(120);
            A=2*foot(O,B,P)-B;
            C=2*foot(O,B,Q)-B;
            D=extension(A,Q,C,P);
            NN=(A+C)/2;
            R=extension(A,C,B,D);
            T=extension(A,C,P,Q);
            Bp=reflect(O,R)*B;
            Dp=reflect(O,R)*D;
            SS=2*foot(O,D,M)-D;
            K=2*foot(O,B,M)-B;
            U=extension(Bp,Dp,P,Q);
            V=(Bp+Dp)/2;

            filldraw(circumcircle(A,M,C),sefil,sex);
            filldraw(circumcircle(R,NN,M),qifil,qui);
            filldraw(circumcircle(A,P,T),qfil,qua);
            filldraw(circumcircle(C,Q,T),qfil,qua);
            draw(Bp--T,tri);
            draw(SS--M,tri);
            draw(K--T,tri);
            draw(B--M,tri);
            filldraw(circumcircle(M,T,K),sfil,sec);
            draw(Bp--U,sec);
            filldraw(circumcircle(A,B,C),fil,pri);
            filldraw(B--P--Q--cycle,fil,pri);
            draw(C--T--P,pri);

            real t=-1.8;
            clip( (-100,t)--(100,t)--(100,100)--(-100,100)--cycle);

            dot("$B$",B,dir(105));
            dot("$A$",A,dir(240));
            dot("$C$",C,dir(10));
            dot("$D$",D,S);
            dot("$P$",P,SW);
            dot("$Q$",Q,E);
            dot("$U$",U,SW);
            dot("$T$",T,W);
            dot("$S$",SS,dir(70));
            dot("$B'$",Bp,dir(75));
            dot("$K$",K,dir(-10));
            dot("$D'$",Dp,dir(220));
            dot("$M$",M,SE);
            dot("$N$",NN,N);
            dot("$R$",R,NW);
            dot("$V$",V,NW);
        \end{asy}
    \end{center}
    Let $B'$ and $D'$ be the reflections of $B$ and $D$ aross $\overline{OR}$. Note that $\measuredangle STP=\measuredangle SAP=\measuredangle SAB=\measuredangle SB'B$, so $T$, $S$, $B'$ collinear. Similarly $T$, $K$, $D'$ collinear. By Reim's theorem on $\omega$, $(MNT)$, we have $B$, $K$, $M$ collinear and $D$, $S$, $M$ collinear.

    Hence $\measuredangle RNM=\measuredangle TNM=\measuredangle TSM=\measuredangle B'SD=\measuredangle D'B'B=\measuredangle RUM$, thus $RNMU$ is cyclic. Since $-1=(AC;RT)$, we have $TA\cdot TC=TR\cdot TN=TU\cdot TM$, so $CMUA$ is cyclic.

    Finally $V$ is the midpoint of $\overline{B'D'}$. Since $-1=(B'D';RU)$, we have $RU\cdot RV=RB'\cdot RD'=RA\cdot RC$, as desired.
\end{proof}

Let $A=A_0$ and $C=C_0$. In summary, to construct $U$ and $V$, we let $O$ be the circumcenter, $R=\overline{AC}\cap\overline{BD}$, and let $B_0$ and $D_0$ be the reflections of $B$ and $D$ across $\overline{OR}$. Then $U$ is the intersection of $\overline{B_0D_0}$ and the polar of $R$, and $V$ is the midpoint of $\overline{B_0D_0}$.

Reflect $U$ and $V$ across $\overline{OR}$, so that $U'$ is the intersection of $\overline{BD}$ and the polar of $R$, and $V'$ is the midpoint of $\overline{BD}$. The task is to compute $U'V'$.

However $-1=(BD;RU')$, so $RB\cdot RD=RU'\cdot RV'$. Thus \[U'V'=RV'+\frac{RB\cdot RD}{RU'}=RV'+\frac{(BD/2)^2-RV'^2}{RV'}=\frac{BD^2}{4RV'}.\]
\begin{center}
    \begin{asy}
        size(6cm); defaultpen(fontsize(10pt));
        pair O,A,B,C,D,R,V,U;
        O=(0,0);
        A=dir(120);
        B=dir(160);
        C=dir(250);
        D=reflect( (0,0),(0,1))*B;
        R=extension(A,C,B,D);
        V=(B+D)/2;
        U=extension(B,D,extension(A,D,B,C),extension(A,B,C,D));

        draw(circle(O,1),gray);
        draw(A--B--C--D--A);
        draw(A--C,gray);
        draw(U--D);

        dot("$A$",A,A);
        dot("$B$",B,NW);
        dot("$C$",C,C);
        dot("$D$",D,D);
        dot("$R$",R,SW);
        dot("$V'$",V,S);
        dot("$U'$",U,W);
    \end{asy}
\end{center}
The rest is just a routine computation. Let $x=\cos\angle BAD$. By Law of Cosines on $\triangle ABD$ and $\triangle BCD$, we have $BD^2$ is equal to the two quantities
\begin{align*}
    3^2+7^2-2\cdot3\cdot7x&=4^2+6^2+2\cdot4\cdot6x\\
    \implies 58-42x&=52+48x\implies x=1/15.
\end{align*}
Hence $BD^2=276/5$. Now \[\frac{BR}{RD}=\frac{\operatorname{Area}(\triangle ABC)}{\operatorname{Area}(\triangle ADC)}=\frac{AB\cdot BC}{AD\cdot DC}=\frac27,\]
so $BR/BD=2/9$ and $RV'/BD=5/18$. Thus \[U'V'=\frac{BD}{4\cdot RV'/BD}=\frac9{10}BD=\frac{9\sqrt{345}}{25},\]
and the requested sum is $900+3450+25=4375$.

---

4375
