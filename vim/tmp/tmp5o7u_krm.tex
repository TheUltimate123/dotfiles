% Input your problem and solution below.
% Three dashes on a newline indicate the breaking points.

---

Find all polynomials $P$ with real coefficients such that \[\frac{P(x)}{yz}+\frac{P(y)}{zx}+\frac{P(z)}{xy}=P(x-y)+P(y-z)+P(z-x)\]
holds for all nonzero real numbers $x$, $y$, $z$ satisfying $2xyz=x+y+z$.

---

The answer is $P(x)\equiv A(x^2+3)$ for any real number $A$, which all work. We now prove these are the only solutions.

Consider the polynomial
\begin{align*}
    Q(x,y,z)&:=xP(x)+yP(y)+zP(z)\\
    &\;\quad-xyz\big[P(x-y)+P(y-z)+P(z-x)\big].
\end{align*}
The main idea is this:
\begin{claim*}
    $Q(x,y,z)=0$ for all complex numbers $x$, $y$, $z$ satisfying $2xyz+x+y+z$.
\end{claim*}
\begin{proof}
We are given $Q(x,y,z)=0$ for all real numbers $x$, $y$, $z$ satisfying $2xyz=x+y+z$, thus the rational function \[R(x,y):=Q\left(x,y,\frac{x+y}{2xy-1}\right)\]
has infinitely many roots, i.e.\ $R\equiv0$.
\end{proof}

Since $Q(x,-x,0)=0$, we have $P$ is even. Also note
\begin{align*}
    0&=Q\left(x,\frac i{\sqrt2},\frac{-i}{\sqrt2}\right)\\
    \implies xP(x)&=\frac x2\left[P\left(x+\frac i{\sqrt2}\right)+P\left(x-\frac i{\sqrt2}\right)+P(\sqrt2i)\right]\\
    \implies-P(\sqrt2i)&\equiv P\left(x+\frac i{\sqrt2}\right)+P\left(x-\frac i{\sqrt2}\right)-2P(x).
\end{align*}
The right-hand expression is a second-order finite difference, so it has degree $\deg P-2$. The left-hand expression is constant, so $\deg P\in\{0,2\}$, and $P(x)\equiv Ax^2+B$ for some $A$, $B$.

Finally check that
\begin{align*}
    2A-B=-P(\sqrt2i)=A\left[\left(x+\frac i{\sqrt2}\right)^2+\left(x-\frac i{\sqrt2}\right)^2-2x^2\right]=-A,
\end{align*}
so $A=3B$, as needed.

