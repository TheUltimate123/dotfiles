% Input your problem and solution below.
% Three dashes on a newline indicate the breaking points.

---

There is an integer $n>1$. There are $n^2$ stations on a slope of a mountain, all at different altitudes. Each of two cable care companies, $A$ and $B$, operates $k$ cable cars; each cable car provides a transfer from one of the stations to a higher one (with no immediate stops). The $k$ cable cars of $A$ have $k$ different starting points and $k$ different finishing points, and a cable car which starts higher also finishes higher. The same conditions hold for $B$. We say that two stations are \emph{linked} by a company if one can start from the lower station and reach the higher one by using one or more cars of that company (no other movements between stations are allowed).

Determine the smallest positive integer $k$ for which one can guarantee that there are two stations that are linked by both companies.

---

The smallest $k$ is $n^2-n+1$.

\bigskip

\textbf{Proof $k=n^2-n$ fails:} Label the stations 1, 2, \ldots, $n^2$ from bottom-up. For company $A$, let the cables link stations $i$ to $i+1$ for all $i$ not divisible by $n$. For company $B$, let the cables link stations $i$ to $i+n$ for all $i$. Thus, each company operates $k$ cable cars, yet no two stations are linked by both companies.

\bigskip

\textbf{Proof $k=n^2-n+1$ works:} Focus on company $A$ for now, and let the cable cars be edges on a graph with $n^2$ vertices. Let there be $a$ connected components, each of which is in the shape of a ``chain.'' Since the graph has $n^2-n+1$ edges, there are at least $n-1$ connected components. Similarly let $b$ be the number of chains among $B$'s cable cars, so $a\le n-1$ and $b\le n-1$.

Since there are $a\le n-1$ chains among $A$'s cable cars, at least one such chain $\ell$ contains at least $n+2$ vertices. By Pigeonhole, at least one chain of $B$'s cable cars contains two vertices of $\ell$, so those two vertices are linked by both $A$ and $B$.

