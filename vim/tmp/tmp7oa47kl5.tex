% Input your problem and solution below.
% Three dashes on a newline indicate the breaking points.

---

Let $ABC$ be an acute-angled triangle with $AB\ne AC$, circumcenter $O$ and circumcircle $\Gamma$. Let the tangents to $\Gamma$ at $B$ and $C$ meet each other at $D$, and let the line $AO$ intersect $\seg{BC}$ at $E$. Denote the midpoint of $\seg{BC}$ by $M$ and let $\seg{AM}$ meet $\Gamma$ again at $N\ne A$. Finally, let $F\ne A$ be a point on $\Gamma$ such that $A$, $M$, $E$, $F$ are concyclic. Prove that $\seg{FN}$ bisects the segment $MD$.

---

\begin{center}
    \begin{asy}
        size(8cm); defaultpen(fontsize(10pt));
        pair A,B,C,O,Ap,EE,M,D,NN,F,X,Fp,HA,K,SS;
        A=dir(120);
        B=dir(215);
        C=dir(325);
        O=(0,0);
        Ap=2O-A;
        EE=extension(A,O,B,C);
        M=(B+C)/2;
        D=-1/M;
        NN=2*foot(O,A,M)-A;
        F=2*foot(O,D,Ap)-Ap;
        X=(D+M)/2;
        Fp=reflect(O,D)*F;
        HA=-B*C/A;
        K=extension(A,D,X,Fp);
        SS=foot(A,B,C);

        draw(X--Fp--D,gray);
        draw(X--F--D,gray);
        draw(O--D,Dotted);
        draw(circumcircle(A,EE,F),dashed);
        draw(A--M,dashed);
        draw(circumcircle(A,B,C));
        draw(Ap--A--HA);
        draw(A--B--C--A--D);
        draw(B--D--C);

        dot("$A$",A,NW);
        dot("$B$",B,B);
        dot("$C$",C,C);
        dot("$O$",O,NE);
        dot("$A'$",Ap,dir(165));
        dot("$E$",EE,dir(240));
        dot("$M$",M,NE);
        dot("$D$",D,S);
        dot("$F$",F,E);
        dot("$X$",X,SE);
        dot("$F'$",Fp,W);
        dot("$H_A$",HA,NE);
        dot("$K$",K,SW);
        dot("$S$",SS,NE);
    \end{asy}
\end{center}
Let $A'$ be the antipode of $A$, let $S$ be the foot from $A$ to $\seg{BC}$, let $H_A=\seg{AS}\cap(ABC)$, let $K=\seg{AD}\cap(ABC)$, let $F'=\seg{DH_A}\cap(ABC)$.
\setcounter{iclaim}0
\begin{iclaim}
    $\seg{FF'}\parallel\seg{BC}$.
\end{iclaim}
\begin{proof}
    Let $T=\seg{AF}\cap\seg{BC}$. Then $TB\cdot TC=TA\cdot TF=TM\cdot TE$, so \[-1=(BC;ET)\stackrel A=(BC;A'F).\]
    But $-1=(BC;H_AF')$, so the claim is true.
\end{proof}
\begin{iclaim}
    $S$, $K$, $X$ collinear.
\end{iclaim}
\begin{proof}
    Let $L$ be the midpoint of $\seg{AK}$, let $Y$ be the point so that $ABCY$ is an isosceles trapezoid, and let $Z$ be the reflection of $A$ over $\seg{BC}$. Note that $K$, $M$, $Y$ collinear, and since $BYCZ$ is a parallelogram, $K$, $M$, $Z$ collinear.

    But by homothety $(A,2)$, we have $\seg{SL}\parallel\seg{ZK}=\seg{KM}$, so $\triangle ASL\sim\triangle DKM$. In particular, \[\frac{AK}{KD}=\frac{2AL}{KD}=\frac{2AS}{MD}=\frac{AS}{XD},\]
    so $S$, $K$, $X$ collinear, as claimed.
\end{proof}

By reflection over $\seg{OD}$, it suffices to prove $X$, $K$, $F'$ collinear. By Brokard's theorem, $\seg{AH_A}\cap\seg{KF'}$ lies on the polar of $\seg{AK}\cap\seg{H_AF'}=D$, or $\seg{BC}$. Thus $X$, $K$, $S$, $F'$ are all collinear, and we are done.


