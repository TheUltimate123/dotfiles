% Input your problem and solution below.
% Three dashes on a newline indicate the breaking points.

---

Find all integers $n$ for which each cell of $n\times n$ table can be filled with one of the letters $I$, $M$, and $O$ in such a way that:
\begin{itemize}
    \item in each row and each column, one third of the entries are $I$, one third are $M$, and one third are $O$; and 
    \item in any diagonal, if the number of entries on the diagonal is a multiple of three, then one third of the entries are $I$, one third are $M$, and one third are $O$.
\end{itemize}
Note that there are $4n-2$ diagonals in total.

---

The answer is $9\mid n$, achieved by tiling the construction
\[
    \begin{bmatrix}
        I&I&I&M&M&M&O&O&O\\
        M&M&M&O&O&O&I&I&I\\
        O&O&O&I&I&I&M&M&M\\
        I&I&I&M&M&M&O&O&O\\
        M&M&M&O&O&O&I&I&I\\
        O&O&O&I&I&I&M&M&M\\
        I&I&I&M&M&M&O&O&O\\
        M&M&M&O&O&O&I&I&I\\
        O&O&O&I&I&I&M&M&M
    \end{bmatrix}
\]
Now we prove this is necessary. Call a set of cells \emph{balanced} if it contains an equal number of $I$'s, $M$'s, and $O$'s.

Dissect the $n\times n$ grid into $3\times3$ grids, and call a cell \emph{good} if it is the center of one of these $3\times3$ grids. Also call a row, column, or diagonal \emph{good} if it contains a good cell. There are $n^2/9$ good cells, so we will show the number of good cells is even; in particular, I claim the set of good cells is balanced.

Consider all good rows, columns, and diagonals. Each good cell is counted four times, and every other cell is counted once; that is, we can count each cell once and then each good cell three more times. But good rows, columns, and diagonals are balanced, and so is the set of all cells, so the set of good cells is balanced too.

