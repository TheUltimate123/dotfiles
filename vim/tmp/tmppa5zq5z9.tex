% Input your problem and solution below.
% Three dashes on a newline indicate the breaking points.
% vim: tw=72

---

Let $ABC$ be an acute triangle with orthocenter $H$ and circumcircle $\Gamma$. A line through $H$ intersects segments $AB$ and $AC$ at $E$ and $F$, respectively. Let $K$ be the circumcenter of $\triangle AEF$, and suppose line $AK$ intersects $\Gamma$ at a point $D$. Prove that line $HK$ and the line through $D$ perpendicular to $\overline{BC}$ meet on $\Gamma$.

---

\begin{customenv}{First solution, by radical axes}
    Let $T$ lie on $\Gamma$ with $\seg{DT}\perp\seg{BC}$, and let line $TH$ intersect $\Gamma$ again at a point $S\ne T$.
    \begin{iclaim*}
        Quadrilaterals $BEHS$ and $CFHS$ are cyclic.
    \end{iclaim*}
    \begin{proof}
        This is just angle chasing: $$\da BSH=\da BDT=90^\circ-\da CBD=90^\circ-\da FAK=\da AEF=\da BEH,$$
        as requested.
    \end{proof}

    Now, $\da KEF=90^\circ-\da FAE=\da EBH$, so $\seg{KE}$ and $\seg{KF}$ are tangent to $(BEHS)$ and $(CFHS)$, respectively. However, $KE^2=KF^2$, so $K$ lies on line $HS$, and the desired conclusion follows. 
\end{customenv}
\begin{customenv}{Second solution, by anti-Steiner points}
    $\measuredangle$ denotes a directed angle modulo $180^\circ$. Denote by $H_A$, $H_B$, $H_C$ the reflections of $H$ over $\overline{BC}$, $\overline{CA}$, $\overline{AB}$, respectively.
    \begin{center}
        \begin{asy}
            size(12cm);
            defaultpen(fontsize(10pt));

            pen pri=red;
            pen sec=orange;
            pen tri=fuchsia;
            pen fil=pri+opacity(0.05);
            pen sfil=sec+opacity(0.05);
            pen tfil=tri+opacity(0.05);

            pair O,A,B,C,H,K,EE,F,D,T,SS,HA,HB,HC;
            O=(0,0);
            A=dir(110);
            B=dir(210);
            C=dir(330);
            H=A+B+C;
            EE=(2A+5B)/7;
            F=extension(EE,H,A,C);
            K=circumcenter(A,EE,F);
            D=2*foot(O,A,K)-A;
            T=intersectionpoint(H -- (H+(K-H)*100),circle(O,1));
            SS=2*foot(O,H,K)-T;
            HA=2*foot(O,A,H)-A;
            HB=2*foot(O,B,H)-B;
            HC=2*foot(O,C,H)-C;

            filldraw(circle(O,1),fil,pri);
            filldraw(circumcircle(A,EE,F),sfil,sec);
            filldraw(circumcircle(D,F,K),sfil,sec);
            filldraw(circumcircle(B,EE,H),tfil,tri);
            filldraw(circumcircle(C,F,H),tfil,tri);
            draw(A--B--C--A,pri);
            draw(A--D,sec);
            draw(A--HA,sec);
            draw(B--HB,sec);
            draw(C--HC,sec);
            draw(EE--F,pri);
            draw(HB--D--HC,tri);
            draw(SS--T,tri);

            dot("$A$",A,N);
            dot("$B$",B,dir(195));
            dot("$C$",C,dir(-15));
            dot("$H$",H,dir(120));
            dot("$K$",K,dir(-40));
            dot("$E$",EE,dir(180));
            dot("$F$",F,dir(30));
            dot("$D$",D,S);
            dot("$T$",T,T);
            dot("$S$",SS,SW);
            dot("$H_A$",HA,NE);
            dot("$H_B$",HB,HB);
            dot("$H_C$",HC,HC);
        \end{asy}
    \end{center}
    \setcounter{iclaim}0
    \begin{iclaim}
        $D$ is the anti-Steiner point of $\overline{EHF}$, and $DEKF$ is cyclic.
    \end{iclaim}
    \begin{proof}
        Let $D'=\overline{EH_C}\cap\overline{FH_B}$ be the anti-Steiner point of $\overline{EHF}$. First note that
        \begin{align*}
            \measuredangle KED'&=\measuredangle KEA+\measuredangle AED'=90^\circ-\measuredangle AFE+\measuredangle AEH_C\\
            &=90^\circ+\measuredangle EFA+\measuredangle HEA=90^\circ+\measuredangle EFA+\measuredangle FEA,
        \end{align*}
        which is symmetric, whence $\measuredangle KED'=90^\circ+\measuredangle EFA+\measuredangle FEA=\measuredangle KFD'$, and $D'EKF$ is cyclic. Now, $$\measuredangle AKE=2\measuredangle AFE=2\measuredangle AFH=\measuredangle H_BFH=\measuredangle D'FE=\measuredangle D'KE,$$
        so $D'\in\overline{AK}$, as required.
    \end{proof}
    \begin{iclaim}
        Let $S$ be the Miquel point of $EFH_BH_C$; $S$ lies on line $HK$.
    \end{iclaim}
    \begin{proof}
        Check that $$\frac{SE}{SF}=\frac{EH_C}{FH_B}=\frac{EH}{FH},$$
        whence $\overline{SH}$ bisects $\angle ESF$ and $\overline{SH}$ passes through $K$, the midpoint of arc $EF$ on $(DEKF)$.
    \end{proof}
\begin{iclaim}
    Quadrilaterals $BEHS$ and $CFHS$ are cyclic.
\end{iclaim}
\begin{proof}
    Notice that $$\measuredangle ESH=\measuredangle ESK=\measuredangle EFK=90^\circ-\measuredangle FAE=\measuredangle ABH=\measuredangle EBH,$$
    so we are done by symmetry.
\end{proof}

Finally, let line $HK$ meet $\Gamma$ at $T\ne S$. Note that $$\measuredangle ATH=\measuredangle ATS=\measuredangle ABS=\measuredangle EBS=\measuredangle EHS=\measuredangle FHT,$$
so $\overline{AT}\parallel\overline{EF}$. However, $\overline{DH_A}$ is the reflection of $\overline{EF}$ over $\overline{BC}$, so $\measuredangle TAH_A=\measuredangle EHA=\measuredangle AH_AD$, and $AD=TH_A$. Thus, $ATDH_A$ is an isosceles trapezoid, and $\overline{AH_A}\parallel\overline{DT}$. This completes the proof. 
\end{customenv}

