% Input your problem and solution below.
% Three dashes on a newline indicate the breaking points.

---

Let $ABC$ be a triangle with $\angle A\ne90\dg$, and let $\seg{BE}$ and $\seg{CF}$ be its altitudes. The bisector of $\angle A$ intersects $\seg{EF}$ and $\seg{BC}$ at $M$ and $N$ respectively. Let $P$ be a point such that $\seg{MP}\perp\seg{EF}$ and $\seg{NP}\perp\seg{BC}$. Prove that line $AP$ bisects $\seg{BC}$.

---

\begin{center}
    \begin{asy}
        size(7cm); defaultpen(fontsize(10pt));

        pair A,B,C,O,EE,F,NN,M,SS,T,P,H;
        A=dir(120);
        B=dir(210);
        C=dir(330);
        O=(B+C)/2;
        EE=foot(B,C,A);
        F=foot(C,A,B);
        NN=extension(A,incenter(A,B,C),B,C);
        M=extension(A,NN,EE,F);
        SS=extension(B,C,EE,F);
        T=foot(SS,A,O);
        P=2*circumcenter(SS,M,NN)-SS;
        H=A+B+C;

        draw(circumcircle(SS,M,NN));
        draw(A--NN,gray);
        draw(B--EE,gray);
        draw(C--F,gray);
        draw(circumcircle(A,EE,F),gray);
        draw(arc(reflect(B,C)*(0,0),1,-10,190),gray);
        draw(B--A--C--SS);
        draw(SS--EE);
        draw(A--O);

        dot("$A$",A,N);
        dot("$B$",B,SE);
        dot("$C$",C,E);
        dot("$O$",O,S);
        dot("$E$",EE,NE);
        dot("$F$",F,dir(110));
        dot("$N$",NN,dir(220));
        dot("$M$",M,dir(250));
        dot("$S$",SS,dir(210));
        dot("$T$",T,dir(75));
        dot("$P$",P,E);
        dot("$H$",H,S);
    \end{asy}
\end{center}
Let $O$ be the midpoint of $\seg{BC}$, let $H$ be the orthocenter, let $T$ be the $A$-Humpty point, and denote $S=\seg{BC}\cap\seg{EF}$. By construction, $T\in\seg{AO}$ and $\seg{AO}\perp\seg{ST}$.

Since $T$ lies on $(HEF)$ and $(HBC)$, $T$ is the Miquel point of $BCFE$. Let $\Psi$ be the spiral similarity at $T$ sending $\seg{BC}$ to $\seg{EF}$. Note that \[\frac{NB}{NC}=\frac{AB}{AC}=\frac{AE}{AF}=\frac{ME}{MF},\]
so $\Psi$ sends $N$ to $M$. It follows that $SMTN$ is cyclic, say with circumcircle $\Gamma$, but by definition, $\seg{SP}$ is a diameter of $\Gamma$. Thus $\angle STP=90\dg$, so $P$ lies on $\seg{ATO}$, as desired.

