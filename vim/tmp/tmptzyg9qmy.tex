% Input your problem and solution below.
% Three dashes on a newline indicate the breaking points.
% vim: tw=72

---

In triangle $ABC$, point $A_1$ lies on side $BC$ and point $B_1$ lies on side $AC$. Let $P$ and $Q$ be points on segments $AA_1$ and $BB_1$, respectively, such that $\overline{PQ}$ is parallel to $\overline{AB}$. Let $P_1$ be a point on line $PB_1$, such that $B_1$ lies strictly between $P$ and $P_1$, and $\angle PP_1C=\angle BAC$. Similarly, let $Q_1$ be a point on line $QA_1$, such that $A_1$ lies strictly between $Q$ and $Q_1$, and $\angle CQ_1Q=\angle CBA$.

Prove that points $P$, $Q$, $P_1$, and $Q_1$ are concyclic.

---

We present two ways to solve this problem, but both are relatively simple. Thus we provide a single diagram that encompasses both solutions.
\begin{center}
    \begin{asy}
        size(11cm);
        defaultpen(fontsize(10pt));

        pair C, A, B, A1, B1, P, Q, P2, Q2, P1, Q1, T, SS, K, O, A2, B2;
        C=dir(110);
        A=dir(205);
        B=dir(335);
        A1=(7C+3B)/10;
        B1=(3C+2A)/5;
        P=(2A+A1)/3;
        Q=extension(B,B1,P,P+(1,0));
        P2=extension(A,B,P,B1);
        Q2=extension(A,B,Q,A1);
        P1=2*foot(circumcenter(A,P2,C),P,B1)-P2;
        Q1=2*foot(circumcenter(B,Q2,C),Q,A1)-Q2;
        T=extension(P,B1,Q,A1);
        SS=extension(A,Q,B,P);
        K=extension(T,C,A,B);
        O=(0,0);
        A2=2*foot(O,A,P)-A;
        B2=2*foot(O,B,Q)-B;

        draw(B--P--Q--A,gray);
        draw(K--T,gray);
        draw(circumcircle(P,Q,P1),gray);
        draw(A--B--C--A--A2);
        draw(B2--B);
        draw(P2--T--Q2);
        draw(circumcircle(A,B,C));
        draw(circumcircle(A,P2,C));
        draw(circumcircle(B,Q2,C));

        dot("$C$",C,dir(105));
        dot("$A$",A,SW);
        dot("$B$",B,SE);
        dot("$A_1$",A1,E);
        dot("$B_1$",B1,W);
        dot("$P$",P,dir(190));
        dot("$Q$",Q,dir(5));
        dot("$P_2$",P2,S);
        dot("$Q_2$",Q2,S);
        dot("$P_1$",P1,dir(120));
        dot("$Q_1$",Q1,dir(-10));
        dot("$T$",T,N);
        dot("$S$",SS,dir(240));
        dot("$K$",K,S);
        dot("$A_2$",A2,A2);
        dot("$B_2$",B2,B2);
    \end{asy}
\end{center}
\begin{customenv}{First solution, by Reim's Theorem}
    Let $\seg{PP_1}$ and $\seg{QQ_1}$ intersect $\seg{AB}$ at $P_2$ and $Q_2$ respectively, and let $\seg{AA_1}$ and $\seg{BB_1}$ intersect the circumcircle of $\triangle ABC$ again at $A_2$ and $B_2$ respectively. By the problem statement it is obvious that $AP_1CP_2$ and $BQ_1CQ_2$ are cyclic. We claim that $P$, $Q$, $A_2$, $B_2$, $P_1$, $Q_1$ are all concyclic.

    Since $\seg{PQ}\parallel\seg{AB}$, by Reim's Theorem $PQA_2B_2$ is cyclic. Now $B_1P_1\cdot B_1P_2=AB_1\cdot CB_1=BB_1\cdot B_1B_2$, whence $PB_2P_2B$ is cyclic. However by Reim's Theorem $P_1B_2PQ$ is also cyclic, so $B_2$ lies on $(PQA_2B_2)$. Similarly $A_2$ lies on $(PQA_2B_2)$, so our claim has been proven. Thus $P$, $Q$, $P_1$, $Q_1$ all lie on a circle, so we are done.
\end{customenv}
\begin{customenv}{Second solution, by DDIT and Pappus' Theorem}
    Let $P_2=\seg{AB}\cap\seg{PP_1}$, $Q_2=\seg{AB}\cap\seg{QQ_1}$, $T=\seg{PP_1}\cap\seg{QQ_1}$, $K=\seg{CT}\cap\seg{AB}$, and $S=\seg{AQ}\cap\seg{BP}$. By construction $AP_1CP_2$ and $BQ_1CQ_2$ are cyclic, and by Pappus' Theorem on $\seg{APA_1}$ and $\seg{BQB_1}$, points $S$, $C$, $T$ are collinear.

    Applying DDIT on $ABPQ$ from $T$, an involution swaps $(\seg{TA},\seg{TP})$, $(\seg{TB},\seg{TQ})$, $(\seg{T\infty_{AB}},\seg{TS})$, where $\infty_{AB}$ is the point at infinity on $\seg{AB}$. Projecting onto $\seg{AB}$, an inversion at $K$ swaps $(A,P_2)$ and $(B,Q_2)$. It follows that $KA\cdot KP_2=KB\cdot KQ_2$, so $\seg{TCSK}$ is the radical axis of $(AP_1CP_2)$ and $(BQ_1CQ_2)$. Now $TP_1\cdot TP_2=TQ_1\cdot TQ_2$, so $P_1P_2Q_2Q_1$ is cyclic.

    Finally, by Reim's Theorem, $PP_1Q_1Q$ is cyclic, and we are done.
\end{customenv}

