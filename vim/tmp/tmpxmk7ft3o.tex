% Input your problem and solution below.
% Three dashes on a newline indicate the breaking points.

---

Let $ABC$ be a triangle with incenter $I$ and circumcenter $O$. A line $\ell$ is drawn parallel to $\seg{BC}$ and tangent to the incircle of $\triangle ABC$. Let $X$, $Y$ be on $\ell$ so that $I$, $O$, $X$ are collinear and $\angle XIY=90^\circ$. Show that $A$, $X$, $O$, $Y$ are concyclic.

---

\begin{center}
\begin{asy}
    size(8cm); defaultpen(fontsize(10pt));

    pair O,A,B,C,I,D,Dp,X,Y,Xp,Yp;
    O=(0,0);
    A=dir(121);
    B=dir(195);
    C=dir(345);
    I=incenter(A,B,C);
    D=foot(I,B,C);
    Dp=2I-D;
    X=extension(I,O,Dp,Dp+B-C);
    Y=extension(X,Dp,I,I+rotate(90)*(O-I));
    Xp=2I-X;
    Yp=2I-Y;

    draw(Xp--X,gray); draw(Y--Yp,gray);
    draw(circumcircle(A,X,Y),dashed);
    draw(incircle(A,B,C));
    draw(A--B--C--A);
    draw(X--Y);

    dot("$O$",O,dir(210));
    dot("$A$",A,N);
    dot("$B$",B,N);
    dot("$C$",C,SE);
    dot("$I$",I,S);
    dot("$D$",D,N);
    dot("$D'$",Dp,S);
    dot("$X$",X,NW);
    dot("$Y$",Y,NE);
    dot("$X'$",Xp,S);
    dot("$Y'$",Yp,S);
\end{asy}
\end{center}
Use complex numbers with $(ABC)$ the unit circle. Let $x'=2i-x$ be $\seg{BC}\cap\seg{OI}$. Then
\begin{align*}
    x'&=\frac{(\seg bc-b\seg c)(i-o)-(\seg io-i\seg o)(b-c)}{(\seg b-\seg c)(i-o)-(\seg i-\seg o)(b-c)}\\
    &=\frac{i\left(\frac cb-\frac bc\right)}{i\left(\frac1b-\frac1c\right)-\seg i(b-c)}=\frac{i\cdot\frac{c^2-b^2}{bc}}{i\cdot\frac{c-b}{bc}+\seg i(c-b)}\\
    &=\frac{i(c+b)}{i+\seg ibc}.
    \intertext{Hence we compute}
    x&=2i-x'=i\left(2-\frac{b+c}{i+\seg ibc}\right)\\
    &=i\left(\frac{2i+2\seg ibc-b-c}{i+\seg ibc}\right).
\end{align*}

Now let $y'=2i-y$ lie on $\seg{BC}$. The intersections $R$, $S$ of $\seg{IY}$ with $(ABC)$ are the roots of the quadratic in $t$:
\begin{align*}
    \frac{t-i}i\in\mathbb I&\iff\frac{t-i}i+\frac{\frac1t-\seg i}{\seg i}=0\\
    &\iff t^2-ti+i/\seg i-ti=0\\
    &\iff t^2-2i\cdot t+i/\seg i=0.
\end{align*}
Hence $r+s=2i$, $rs=i/\seg i$, and
\begin{align*}
    y'&=\frac{bc(r+s)-rs(b+c)}{bc-rs}\\
    &=\frac{2bci-\frac i{\seg i}(b+c)}{bc-\frac i{\seg i}}
    =\frac{2bci\seg i-i(b+c)}{bc\seg i-i}.
    \intertext{Hence we compute}
    y&=2i-y'=2i-\frac{2bci\seg i-i(b+c)}{bc\seg i-i}\\
    &=\frac{-2i^2+i(b+c)}{bc\seg i-i}=\frac{i(b+c-2i)}{bc\seg i-i}.
\end{align*}
Let $P=\frac{a-y}a$, $Q=\frac{x-y}x$, $F=\frac PQ$. It suffices to show $F\in\mathbb R$. Let $a=u^2$, $b=v^2$, $c=w^2$, so that $i=-(uv+vw+wu)$.

We have
\begin{align*}
    P&=\frac{a-y}a=1-\frac ya
    =1-\frac{i(b+c-2i)}{a(bc\seg i-i)}=\frac{abc\seg i-i(a+b+c-2i)}{a(bc\seg i-i)}\\
    &=\frac{-u^2v^2w^2\left(\frac1{uv}+\frac1{vw}+\frac1{wu}\right)+(uv+vw+wu)(u+v+w)^2}{u^2\left(-v^2w^2\left(\frac1{uv}+\frac1{vw}+\frac1{wu}\right)+uv+vw+wu\right)}\\
    &=\frac{(u+v+w)\left[-uvw+(uv+vw+wu)(u+v+w)\right]}{u\left(u^2-vw\right)(v+w)}\\
    &=\frac{u+v+w}{u\left(u^2-vw\right)(v+w)}\left[2uvw+\sum_\mathrm{sym}u^2v\right]\\
    &=\frac{(u+v+w)(u+v)(v+w)(w+u)}{u\left(u^2-vw\right)(v+w)}\\
    &=\frac{(u+v+w)(u+v)(u+w)}{u\left(u^2-vw\right)}.
\end{align*}
The main computation:
\begin{align*}
    Q&=\frac{x-y}x=1-\frac yx=1-\left(\frac{i(b+c-2i)}{bc\seg i-i}\bigg/\frac{i(2i+2\seg ibc-b-c)}{i+\seg ibc}\right)\\
    &=\frac{(bc\seg i-i)(2i+2\seg ibc-b-c)-(b+c-2i)(i+\seg ibc)}{(bc\seg i-i)(2i+2\seg i-b-c)}\\
    &=\frac{2(i+\seg ibc)(bc\seg i-i)-(b+c)(bc\seg i-i)-(b+c)(bc\seg i+i)+2i(i+\seg ibc)}{(bc\seg i-i)(2i+2\seg ibc-b-c)}\\
    &=\frac{2(i+\seg ibc)bc\seg i-2(b+c)bc\seg i}{(bc\seg i-i)(2i+2\seg ibc-b-c)}\\
    &=\frac{2bc\seg i(i+\seg ibc-b-c)}{(bc\seg i-i)(2i+2\seg ibc-b-c)}\\
    &=\frac{2v^2w^2\left(\frac1{uv}+\frac1{vw}+\frac1{wu}\right)\left(v^2+w^2+uv+vw+wu+v^2w^2\left(\frac1{uv}+\frac1{vw}+\frac1{wu}\right)\right)}{\left(v^2w^2\left(\frac1{uv}+\frac1{vw}+\frac1{wu}\right)-uv-vw-wu\right)\left(v^2+w^2+2(uv+vw+wu)+2v^2w^2\left(\frac1{uv}+\frac1{vw}+\frac1{wu}\right)\right)}\\
    &=\frac{\left[2\frac{vw}u(u+v+w)\right]\cdot\left[\frac1u\left(2uvw+\sum_\mathrm{sym}u^2v\right)\right]}{\left[\frac1u\left(u^2-vw\right)(v+w)\right]\cdot\left[\frac1u\left(2uvw(u+v+w)+u(u+v+w)^2-u^3\right)\right]}\\
    &=\frac{2vw(u+v+w)(u+v)(u+w)}{\left(u^2-vw\right)\big(2vw(u+v+w)+u(v+w)(2u+v+w)\big)}.
\end{align*}

From here, \[F=\frac PQ=\frac{2uvw(u+v+w)+u(v+w)(2u+v+w)}{2uvw},\]
and we can check
\begin{align*}
    \seg F&=\frac{\frac2{vw}\left(\frac1u+\frac1v+\frac1w\right)+\frac1u\left(\frac1v+\frac1w\right)\left(\frac2u+\frac1v+\frac1w\right)}{\frac2{uvw}}\\
    &=\frac{2u(uv+vw+wu)+(v+w)(2vw+wu+uv)}{2uvw}\\
    &=\frac{2vw(u+v+w)+2\left(u^2v+u^2w\right)+(v+w)(uw+uv)}{2uvw}\\
    &=\frac{2vw(u+v+w)+u(v+w)(2u+v+w)}{2uvw}=F.
\end{align*}
This implies $F\in\mathbb R$, and we are done.

